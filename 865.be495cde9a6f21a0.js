"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[865],{7918:(T,E,a)=>{a.d(E,{S:()=>h});var v=a(520),S=a(591),A=a(1086),b=a(1406),l=a(4850),u=a(2986),p=a(2340),t=a(5e3),D=a(7261),M=a(189);let h=(()=>{class d{constructor(s,o,c){this.http=s,this.snackBar=o,this.ubicationService=c,this.dataOptionsForms$=new S.X(null),this.stageEditSubject$=new S.X(null),this.urlUtils="src/app/shared/utils/data/",this.resultSubject$=new S.X(null)}get optionsForms$(){return this.dataOptionsForms$}get resultItems$(){return this.resultSubject$}setItems(s){this.resultSubject$.next(s)}get stageOnEdit(){return this.stageEditSubject$}setStageOnEdit(s){this.stageEditSubject$.next(s)}loadData(){(0,A.of)(this.ubicationService.getStates(),this.ubicationService.getCities(),this.ubicationService.getCountries()).pipe((0,b.b)(c=>c)).subscribe(c=>console.log(c))}storeStage(s){return this.http.post(`${p.N.API}stages`,s).pipe((0,l.U)(o=>(this.getStages(1,20,"","desc").pipe((0,u.q)(1)).subscribe(),this.openSnackBar("Se cre\xf3 correctamente","success-snack-bar"),o.data)))}updateStage(s){return s._method="put",this.http.post(`${p.N.API}stages/${s.id}`,s).pipe((0,l.U)(o=>(this.getStages(1,20,"","desc").pipe((0,u.q)(1)).subscribe(),this.openSnackBar("Actualizado correctamente","success-snack-bar"),o.data)))}deleteStage(s){return this.http.delete(`${p.N.API}stages/${s}`).pipe((0,l.U)(o=>(this.getStages(1,20,"","desc").pipe((0,u.q)(1)).subscribe(),this.openSnackBar("Eliminado correctamente","success-snack-bar"),o.data)))}getStage(s){return this.http.get(`${p.N.API}stages/${s}`).pipe((0,l.U)(o=>(this.setStageOnEdit(o.data),o.data)))}getStages(s=1,o=20,c="",P="desc"){return this.http.get(`${p.N.API}stages`,{params:(new v.LE).set("page",s.toString()).set("filter",c).set("sort",P).set("per_page",o.toString())}).pipe((0,l.U)(C=>(this.setStageOnEdit(null),this.setItems(C),C)))}openSnackBar(s,o,c=""){this.snackBar.open(s,c,{duration:2e3,horizontalPosition:"center",verticalPosition:"top",panelClass:o})}}return d.\u0275fac=function(s){return new(s||d)(t.LFG(v.eN),t.LFG(D.ux),t.LFG(M._))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},5865:(T,E,a)=>{a.r(E),a.d(E,{StagesModule:()=>B});var v=a(9808),S=a(325),A=a(3075),b=a(6087),l=a(4850),u=a(2986),p=a(303),t=a(5e3),D=a(7918),M=a(8966),h=a(9224),d=a(7423),O=a(5245),s=a(953),o=a(3160);const c=function(){return[20,50,100]},C=[{path:"",component:(()=>{class n{constructor(e,i){this.stageService=e,this.dialog=i,this.columns=[{title:"Nombre",col:"name"},{title:"Etapa de fin",col:"end",type:"boolean"}],this.pageDefault=1,this.perPage=10,this.orden="desc",this.filter="",this.result=this.stageService.resultItems$}ngOnInit(){this.getStages(this.pageDefault,this.perPage,this.filter,this.orden)}paginatorChange(e){this.getStages(e.pageIndex+1,e.pageSize)}getStages(e,i,r,g){this.subscroption=this.stageService.getStages(e,i,r,g).subscribe(f=>this.loadData())}loadData(){this.dataSource=this.result.pipe((0,l.U)(e=>e.data.data.map(r=>({id:r.id,name:r.name,end:null==r?void 0:r.end})))),this.totalResut=this.result.pipe((0,l.U)(e=>e.data.total))}search(e){this.getStages(this.pageDefault,this.perPage,e,this.orden)}deleteItem(e){return this.stageService.deleteStage(e)}itemAction(e){"delete"===e.action&&this.deleteItem(e.element.id).pipe((0,u.q)(1)).subscribe(),"edit"===e.action&&this.openDialog("Edita Etapa",e.element)}openDialog(e="Agrega Etapa",i){const r={title:e,data:this.setFields(i)};return this.dialog.open(p.Q,{width:"550px",data:r}).afterClosed().subscribe(f=>{f&&(f.id?this.updateStage(f):this.storeStage(f))})}updateStage(e){this.stageService.updateStage(e).pipe((0,u.q)(1)).subscribe()}storeStage(e){this.stageService.storeStage(e).pipe((0,u.q)(1)).subscribe(i=>{})}setFields(e){return[{nameControl:"id",type:"hidden",value:null==e?void 0:e.id,label:"Id"},{nameControl:"name",type:"text",value:null==e?void 0:e.name,validators:[A.kI.required],label:"Nombre",class:"mvd-col1--1"},{nameControl:"end",type:"checkbox",value:null==e?void 0:e.end,label:"Etapa final"}]}ngOnDestroy(){this.subscroption.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(D.S),t.Y36(M.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["mvd-stages"]],viewQuery:function(e,i){if(1&e&&t.Gf(b.NW,7),2&e){let r;t.iGM(r=t.CRH())&&(i.paginator=r.first)}},decls:23,vars:11,consts:[[1,"card","mat-elevation-z16","animate__animated","animate__slideInRight"],[1,"actions"],["mat-flat-button","","color","primary",3,"click"],[1,"material-icons-round"],["mat-flat-button","","color","","disabled","",1,"btn-simple"],[3,"noteFilterBy","changeSearch"],[3,"columns","dataSource","actionChange"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"border"]],template:function(e,i){1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3,"Etapas Muestras"),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5,"Administrar Etapas"),t.qZA(),t.TgZ(6,"div",1)(7,"button",2),t.NdJ("click",function(){return i.openDialog()}),t.TgZ(8,"mat-icon",3),t._uU(9,"add"),t.qZA(),t.TgZ(10,"span"),t._uU(11,"Crear"),t.qZA()(),t.TgZ(12,"button",4)(13,"mat-icon",3),t._uU(14,"save_alt"),t.qZA(),t._uU(15," Exportar "),t.qZA()(),t.TgZ(16,"mvd-input-search",5),t.NdJ("changeSearch",function(g){return i.search(g)}),t.qZA()(),t.TgZ(17,"mat-card-content")(18,"mvd-data-table",6),t.NdJ("actionChange",function(g){return i.itemAction(g)}),t.ALo(19,"async"),t.qZA(),t.TgZ(20,"mat-paginator",7),t.NdJ("page",function(g){return i.paginatorChange(g)}),t.ALo(21,"async"),t.qZA()(),t._UZ(22,"span",8),t.qZA()),2&e&&(t.xp6(16),t.Q6J("noteFilterBy","Filtra por Nombre"),t.xp6(2),t.Q6J("columns",i.columns)("dataSource",t.lcZ(19,6,i.dataSource)),t.xp6(2),t.Q6J("length",t.lcZ(21,8,i.totalResut))("pageSize",i.perPage)("pageSizeOptions",t.DdM(10,c)))},directives:[h.a8,h.dk,h.n5,h.$j,d.lW,O.Hw,s.V,h.dn,o.Q,b.NW],pipes:[v.Ov],styles:[""]}),n})()}];let I=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[S.Bz.forChild(C)],S.Bz]}),n})();var U=a(8203);let B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[v.ez,I,U.m]]}),n})()}}]);